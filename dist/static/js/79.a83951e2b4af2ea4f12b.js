(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{MAhN:function(e,t,a){"use strict";a.r(t);var s=a("YEIV"),o=a.n(s),i={name:"filterTable",data:function(){var e,t=this,a=this;return{codes:{value:"code",label:"name",lazy:!0,lazyLoad:function(e,t){e.data&&(e.add="");var s=e.level;1==s?(a.build=e.value,e.add=e.value):2==s?(a.unit=e.value,e.add=a.build+","+e.value):3==s&&(e.add=a.build+","+a.unit+","+e.value),a.$request.houseListAll({type:s,code:e.add}).then((function(e){if(200==e.data.status){var o=e.data.data;s>1&&o.forEach((function(e){e.leaf=s>=3})),t(o)}else a.$message.error(e.msg)}))}},loading:!1,chooseLoading:!1,chooseShow:!1,commonSearchList:[{prop:"businessTypeId",label:"报事类型",type:"select",options:[]},{prop:"userName",label:"住户姓名"},{prop:"buildingCode",label:"楼栋编码"},{prop:"mobile",label:"手机号"},{prop:"businessStatus",label:"处理状态",type:"select",options:[]},{prop:"times",label:"提交时间段",type:"datePicker"}],tableOperations:[{label:"处理录入",icon:"iconfont icon-process",handler:function(e){return t.handleEdit(e)}}],tableOptions:{border:!1,stripe:!1,highlightCurrentRow:!0,multiSelect:!1},open:!1,title:"",chooseTableOptions:{stripe:!1,highlightCurrentRow:!0,multiSelect:!1,border:!1},chooseTableOperations:[{label:"选择",icon:"el-icon-edit",handler:function(e){return t.choose(e)}}],chooseColumn:[{prop:"userName",label:"用户姓名"},{prop:"certificateTypeIdStr",label:"证件类型"},{prop:"certificateCode",label:"证件号码"},{prop:"userSexStr",label:"性别"},{prop:"contactMethod",label:"联系人电话"},{prop:"mobile",label:"电话"},{prop:"liveStatusStr",label:"居住状态"}],chooseSearchList:[{prop:"buildingCode",label:"房间编码"},{prop:"userName",label:"用户姓名"},{prop:"certificateCode",label:"身份证号"},{prop:"mobile",label:"电话号码"},{prop:"hao",label:"门禁号"},{prop:"liveType",label:"证件类型",type:"select",options:[]},{prop:"liveStatus",label:"居住状态",type:"select",options:[]},{prop:"liveTypeId",label:"住户类型",type:"select",options:[]}],column:[{prop:"businessType",label:"报事类型"},{prop:"userName",label:"住户姓名"},{prop:"buildingCode",label:"楼栋编码"},{prop:"mobile",label:"手机号"},{prop:"businessContent",label:"报事描述"},{prop:"submitMethodValue",label:"提交方式"},{prop:"businessStatusValue",label:"处理状态"},{prop:"createTime",label:"创建时间"},{prop:"createBy",label:"提交人"}],ids:[],tableData:[],chooseTableData:[],total:0,chooseTotal:0,form:{},rules:{businessTypeId:[{required:!0,message:"报事类型未选择",trigger:"change"}],userName:[{required:!0,message:"住户未选择",trigger:"change"}],buildingCode:[{required:!0,message:"楼栋未选择",trigger:"change"}],mobile:[{required:!0,message:"手机号不能为空",trigger:"change"}]},dictList:{},businessDict:[],multiple:!0,chooseParams:(e={page:1,pageSize:10,newsTitle:void 0,publishStatus:void 0},o()(e,"newsTitle",void 0),o()(e,"publishStatus",void 0),o()(e,"newsTitle",void 0),o()(e,"publishStatus",void 0),o()(e,"newsTitle",void 0),o()(e,"publishStatus",void 0),e),params:{userName:void 0,businessTypeId:void 0,page:1,pageSize:20,times:void 0,endTime:void 0,startTime:void 0,buildingCode:void 0,mobile:void 0,businessStatus:void 0}}},mounted:function(){var e=this;this.$request.repairGetBusinessDict().then((function(t){200==t.data.status&&(e.businessDict=t.data.data)})),this.$request.detailFindEnum().then((function(t){var a=t.data.data;e.chooseSearchList.forEach((function(e){"select"==e.type&&"liveStatus"==e.prop&&a.liveStatusEnum.map((function(t){e.options.push({label:t.value,value:t.type})})),"select"==e.type&&"liveTypeId"==e.prop&&a.reasonEnum.map((function(t){e.options.push({label:t.value,value:t.type})})),"select"==e.type&&"liveType"==e.prop&&a.certificateEnum.map((function(t){e.options.push({label:t.value,value:t.type})}))}))})),this.$request.findRepairAlleuems().then((function(t){e.commonSearchList.forEach((function(e){"select"==e.type&&"businessStatus"==e.prop&&t.data.data.businessStatusEnum.map((function(t){e.options.push({label:t.value,value:t.type})})),"select"==e.type&&"businessTypeId"==e.prop&&t.data.data.businessTypeEnum.map((function(t){e.options.push({label:t.value,value:t.type})}))}))})),this.getList(),this.chooseGetList()},methods:{choose:function(e){var t=this;this.$request.peopleFfindUser({id:e.id,userCode:e.userCode}).then((function(e){200==e.data.status?(t.form.userName=e.data.data.userName,t.form.userCode=e.data.data.userCode,t.chooseShow=!1):t.$message.error(e.data.msg)}))},chooseGetList:function(){var e=this;this.chooseLoading=!0,this.$request.detailAll(this.chooseParams).then((function(t){200===t.data.status?(e.chooseTableData=t.data.data.rows,e.chooseTotal=t.data.data.records,e.chooseParams.page=t.data.data.page,e.chooseLoading=!1):(e.chooseLoading=!1,e.$message.error(t.data.msg))}))},chooseHandleQuery:function(){this.chooseParams.page=1,this.chooseGetList()},chooseResetQuery:function(){var e;this.chooseParams=(e={page:1,pageSize:10,newsTitle:void 0,publishStatus:void 0},o()(e,"newsTitle",void 0),o()(e,"publishStatus",void 0),o()(e,"newsTitle",void 0),o()(e,"publishStatus",void 0),o()(e,"newsTitle",void 0),o()(e,"publishStatus",void 0),e),this.chooseHandleQuery()},choosePeople:function(){this.chooseShow=!0},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),this.single=1!=e.length,this.multiple=!e.length},handleQuery:function(){this.params.page=1,this.params.times?(this.params.startTime=this.params.times[0],this.params.endTime=this.params.times[1]):(this.params.startTime=void 0,this.params.endTime=void 0),this.getList()},resetQuery:function(){this.params={userName:void 0,businessTypeId:void 0,page:1,pageSize:20,times:void 0,endTime:void 0,startTime:void 0,buildingCode:void 0,mobile:void 0,businessStatus:void 0},this.handleQuery()},cancel:function(){this.open=!1,this.reset(),this.$refs.form.resetFields()},submitForm:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.form.buildingCode=e.form.buildingCode.toString(),e.$request.repairAdd(e.form).then((function(t){200===t.data.status?(e.msgSuccess("新增成功"),e.open=!1,e.getList(),e.$refs.form.resetFields()):e.$message.error(t.data.msg)})))}))},reset:function(){this.form={businessTypeId:void 0,userName:void 0,userCode:void 0,buildingCode:void 0,mobile:void 0,businessContent:void 0}},addList:function(){this.reset(),this.open=!0,this.title="新增业主报事"},getList:function(){var e=this;this.loading=!0,this.$request.repairFindBusinessQuery(this.params).then((function(t){200==t.data.status?(e.tableData=t.data.data.rows,e.total=t.data.data.records,e.params.page=t.data.data.page,e.loading=!1):(e.$message.error(t.data.msg),e.loading=!1)}))},Export:function(){this.$request.downloadExcelBusiness(this.params)},handleEdit:function(e){this.$router.push({path:"/ownerRepairsDetail",name:"ownerRepairsDetail",params:{code:e.businessCode}})}}},r=(a("yvkB"),a("KHd+")),l=Object(r.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contant"},[a("div",{staticStyle:{"padding-right":"20px",background:"#fff"}},[a("CommonSearch",{attrs:{queryParams:e.params,searchList:e.commonSearchList},on:{resetQuery:e.resetQuery,handleQuery:e.handleQuery,"update:queryParams":function(t){e.params=t},"update:query-params":function(t){e.params=t}}})],1),e._v(" "),a("div",{staticClass:"operation"},[a("div",{staticClass:"button"},[a("el-row",{staticClass:"operations-row",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:e.addList}},[e._v("新增报事")])],1),e._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini"},on:{click:e.Export}},[e._v("导出Excel")])],1)],1)],1),e._v(" "),a("CommonTable",{attrs:{total:e.total,loading:e.loading,defColumns:e.column,dataList:e.tableData,options:e.tableOptions,page:e.params.page,limit:e.params.pageSize,operations:e.tableOperations},on:{pagination:e.getList,"update:page":function(t){return e.$set(e.params,"page",t)},"update:limit":function(t){return e.$set(e.params,"pageSize",t)},"selection-change":e.handleSelectionChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,"before-close":e.cancel,visible:e.open,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"报事类型：",prop:"businessTypeId"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.businessTypeId,callback:function(t){e.$set(e.form,"businessTypeId",t)},expression:"form.businessTypeId"}},e._l(e.businessDict,(function(e){return a("el-option",{key:e.type,attrs:{label:e.dictName,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"住户姓名：",prop:"userName"}},[a("el-input",{staticClass:"elinput",attrs:{disabled:"",placeholder:"请输入住户姓名"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}}),e._v(" "),a("el-button",{staticClass:"btn-buka",attrs:{type:"primary"},on:{click:e.choosePeople}},[e._v("选择")])],1),e._v(" "),a("el-form-item",{attrs:{label:"楼栋：",prop:"buildingCode"}},[a("el-cascader",{attrs:{placeholder:"请选择",props:e.codes},model:{value:e.form.buildingCode,callback:function(t){e.$set(e.form,"buildingCode",t)},expression:"form.buildingCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号：",prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"事件描述：",prop:"businessContent"}},[a("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入事件描述"},model:{value:e.form.businessContent,callback:function(t){e.$set(e.form,"businessContent",t)},expression:"form.businessContent"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"住户选择",width:"800px",visible:e.chooseShow},on:{"update:visible":function(t){e.chooseShow=t}}},[a("div",{staticStyle:{"margin-top":"-20px"}},[a("CommonSearch",{attrs:{queryParams:e.chooseParams,searchList:e.chooseSearchList},on:{resetQuery:e.chooseResetQuery,handleQuery:e.chooseHandleQuery,"update:queryParams":function(t){e.chooseParams=t},"update:query-params":function(t){e.chooseParams=t}}})],1),e._v(" "),a("CommonTable",{attrs:{total:e.chooseTotal,loading:e.chooseLoading,tooltipShow:!0,defColumns:e.chooseColumn,dataList:e.chooseTableData,options:e.chooseTableOptions,page:e.chooseParams.page,limit:e.chooseParams.pageSize,operations:e.chooseTableOperations},on:{pagination:e.chooseGetList,"update:page":function(t){return e.$set(e.chooseParams,"page",t)},"update:limit":function(t){return e.$set(e.chooseParams,"pageSize",t)}}})],1)],1)}),[],!1,null,"0c001c60",null);t.default=l.exports},xQTa:function(e,t,a){},yvkB:function(e,t,a){"use strict";var s=a("xQTa");a.n(s).a}}]);
//# sourceMappingURL=79.a83951e2b4af2ea4f12b.js.map