(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{FLiJ:function(e,t,a){"use strict";var i=a("gEds");a.n(i).a},GQeE:function(e,t,a){e.exports={default:a("iq4v"),__esModule:!0}},Mqbl:function(e,t,a){var i=a("JB68"),r=a("w6GO");a("zn7N")("keys",(function(){return function(e){return r(i(e))}}))},dBoV:function(e,t,a){"use strict";a.r(t);var i=a("GQeE"),r=a.n(i),s={name:"userControl",data:function(){var e=this;return{isShow:!1,fileImg:[],uploadImgList:[],header:{"Content-Type":"multipart/form-data"},dialogImageUrl:"",dialogVisible:!1,disabled:!1,loading:!1,tableOptions:{stripe:!1,highlightCurrentRow:!0,multiSelect:!1},tableOperations:[{label:"受理",icon:"iconfont icon-accept",handler:function(t){return e.handleUpdate(t)}}],commonSearchList:[{prop:"buildingCode",label:"房屋编码 "},{prop:"userName",label:" 住户姓名"},{prop:"mobile",label:"住户手机"},{prop:"repaireCode",label:"工单编号"},{prop:"times",label:"提交时间",type:"datePicker"}],open:!1,title:"",column:[{prop:"createTime",label:"提交时间 "},{prop:"repaireCode",label:"工单编号",widht:"180"},{prop:"repairType",label:"报修类型",widht:"180"},{prop:"buildingCode",label:"房屋编码"},{prop:"userName",label:"住户信息",render:function(e,t){return e("div",[t.row.userName+"/ "+t.row.mobile])}},{prop:"repaireStatus",label:"处理状态",formatter:function(t,a,i){return e.selectDictLabel(e.roleStatus,t.repaireStatus)}}],tableData:[],dictLists:[],total:0,form:{},rules:{userName:[{required:!0,message:"姓名不能为空",trigger:"change"}],mobile:[{required:!0,message:"手机号不能为空",trigger:"change"},this.$rules.mobile("请输入正确的手机号","change")],buildingCode:[{required:!0,message:"房号不能为空",trigger:"change"}],repairType:[{required:!0,message:"维修事项不能为空",trigger:"change"}]},roleStatus:[],params:{page:1,pageSize:20,userName:void 0,mobile:void 0,repaireCode:void 0,repaireStatus:10,buildingCode:void 0,times:void 0,endTime:void 0,startTime:void 0}}},created:function(){var e=this;this.$request.findRepairAlleuems().then((function(t){var a=[],i=t.data.data;e.dictLists=t.data.data;for(var r=0;r<i.repaireProgressEnum.length;r++){var s={};s.value=i.repaireProgressEnum[r].type,s.label=i.repaireProgressEnum[r].value,a.push(s)}e.roleStatus=a})),this.getList()},methods:{getLocalImgs:function(e,t){var a=this;this.uploadImgList.forEach((function(t,i){t.url==e.url&&a.uploadImgList.splice(i,1)})),console.log(this.uploadImgList)},uploadSectionFile:function(e){var t=this,a=new FormData;a.append("file",e.file),this.$request.upload(a).then((function(e){var a={url:e.data.data.split(",")[1]};t.fileImg.push(a),t.uploadImgList.push({code:e.data.data.split(",")[0],url:e.data.data.split(",")[1]}),console.log(t.fileImg)}))},getLocalImg:function(e){var t=e.url;this.dialogImageUrl=t,this.dialogVisible=!0},selectDictLabel:function(e,t){var a=[];return r()(e).map((function(i){if(e[i].value==""+t)return a.push(e[i].label),!1})),a.join("")},handleQuery:function(){this.params.page=1,this.params.times?(this.params.startTime=this.params.times[0],this.params.endTime=this.params.times[1],this.params.times=void 0):(this.params.startTime=void 0,this.params.endTime=void 0),this.getList()},resetQuery:function(){this.params={page:1,pageSize:20,userName:void 0,mobile:void 0,repaireCode:void 0,repaireStatus:10,buildingCode:void 0,times:void 0,endTime:void 0,startTime:void 0},this.handleQuery()},handleUpdate:function(e){var t=this;this.reset();var a=this;this.isShow=!0;var i=e.repaireCode;this.$request.selectOrderDetails(i).then((function(e){if(200==e.data.status){if(t.form=e.data.data,e.data.data.repaireImageList)for(var i=e.data.data.repaireImageCodes.split(","),r=0;r<e.data.data.repaireImageList.length;r++)a.uploadImgList.push({code:i[r],url:e.data.data.repaireImageList[r]}),a.fileImg.push({uid:r,url:e.data.data.repaireImageList[r]});t.open=!0,t.title="修改报修"}else t.$message.error(e.data.msg)}))},cancel:function(){this.open=!1,this.reset(),this.$refs.form.resetFields(),this.$refs.upload.clearFiles(),this.fileImg=[],this.uploadImgList=[]},submitForm:function(){var e=this;console.log(this.form),this.$refs.form.validate((function(t){if(t){for(var a=[],i=0;i<e.uploadImgList.length;i++)a.push(e.uploadImgList[i].code),console.log(e.uploadImgList[i].code);e.form.repaireImageCodes=a.toString(),e.form.createTime?e.$request.repairUpdateRepair(e.form).then((function(t){200===t.data.status?(e.msgSuccess("受理成功"),e.open=!1,e.getList(),e.$refs.form.resetFields()):e.$message.error(t.data.msg)})):e.$request.saveRepair(e.form).then((function(t){200===t.data.status?(e.msgSuccess("新增成功"),e.open=!1,e.getList(),e.$refs.form.resetFields()):e.$message.error(t.data.msg)}))}}))},reset:function(){this.form={userName:void 0,mobile:void 0,buildingCode:void 0,repairType:void 0,repairDesc:void 0,remark:void 0,repaireImageCodes:void 0}},addList:function(){this.reset(),this.open=!0,this.title="新增",this.isShow=!1},getList:function(){var e=this;this.loading=!0,this.$request.getRepairList(this.params).then((function(t){200===t.data.status?(e.tableData=t.data.data.rows,e.total=t.data.data.records,e.params.page=t.data.data.page,e.loading=!1):(e.$message.error(t.data.msg),e.loading=!1)}))}}},o=(a("FLiJ"),a("KHd+")),l=Object(o.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticStyle:{"padding-right":"20px",background:"#fff"}},[a("CommonSearch",{attrs:{queryParams:e.params,searchList:e.commonSearchList},on:{resetQuery:e.resetQuery,handleQuery:e.handleQuery,"update:queryParams":function(t){e.params=t},"update:query-params":function(t){e.params=t}}})],1),e._v(" "),a("div",{staticClass:"operation"},[a("div",{staticClass:"button"},[a("el-row",{staticClass:"operations-row",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:e.addList}},[e._v("新增")])],1)],1)],1),e._v(" "),a("CommonTable",{attrs:{total:e.total,loading:e.loading,defColumns:e.column,dataList:e.tableData,options:e.tableOptions,page:e.params.page,limit:e.params.pageSize,operations:e.tableOperations},on:{pagination:e.getList,"update:page":function(t){return e.$set(e.params,"page",t)},"update:limit":function(t){return e.$set(e.params,"pageSize",t)}}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,"before-close":e.cancel,visible:e.open,width:"700px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"姓名:",prop:"userName"}},[a("el-input",{attrs:{disabled:e.isShow,placeholder:"请输入姓名"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"手机号:",prop:"mobile"}},[a("el-input",{attrs:{disabled:e.isShow,placeholder:"请输入手机号"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"房号:",prop:"buildingCode"}},[a("el-input",{attrs:{disabled:e.isShow,placeholder:"请输入房号"},model:{value:e.form.buildingCode,callback:function(t){e.$set(e.form,"buildingCode",t)},expression:"form.buildingCode"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"维修事项:",prop:"repairType"}},[a("el-select",{attrs:{disabled:e.isShow,placeholder:"请选择"},model:{value:e.form.repairType,callback:function(t){e.$set(e.form,"repairType",t)},expression:"form.repairType"}},e._l(e.dictLists.repairEnum,(function(e){return a("el-option",{key:e.type,attrs:{label:e.value,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上传图片:",prop:"managerCode"}},[a("el-upload",{ref:"upload",attrs:{disabled:e.isShow,action:"uploadUrl","list-type":"picture-card","http-request":e.uploadSectionFile,headers:e.header,"with-credentials":!0,accept:"image/png, image/gif, image/jpg, image/jpeg","on-preview":e.getLocalImg,"on-remove":e.getLocalImgs,"file-list":e.fileImg}},[a("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),e._v(" "),a("el-form-item",{attrs:{label:"维修描述:",prop:"repairDesc"}},[a("el-input",{attrs:{disabled:e.isShow,placeholder:"请输入维修描述"},model:{value:e.form.repairDesc,callback:function(t){e.$set(e.form,"repairDesc",t)},expression:"form.repairDesc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注:",prop:"remark"}},[a("el-input",{attrs:{disabled:e.isShow,type:"textarea",autosize:"",placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v(e._s(e.isShow?"受理":"提交"))]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{width:"600px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)}),[],!1,null,"5418c304",null);t.default=l.exports},gEds:function(e,t,a){},iq4v:function(e,t,a){a("Mqbl"),e.exports=a("WEpk").Object.keys},zn7N:function(e,t,a){var i=a("Y7ZC"),r=a("WEpk"),s=a("KUxP");e.exports=function(e,t){var a=(r.Object||{})[e]||Object[e],o={};o[e]=t(a),i(i.S+i.F*s((function(){a(1)})),"Object",o)}}}]);
//# sourceMappingURL=29.22980d3c498d487d4bb6.js.map