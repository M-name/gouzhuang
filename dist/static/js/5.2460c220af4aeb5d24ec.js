(window.webpackJsonp=window.webpackJsonp||[]).push([[5,85],{"4A7B":function(e,t,a){},"8DEy":function(e,t,a){var i=a("MhL/"),o=a("S5+y");a("k6n4")("keys",(function(){return function(e){return o(i(e))}}))},EPZ6:function(e,t,a){e.exports={default:a("xSEk"),__esModule:!0}},EiDx:function(e,t,a){"use strict";a.r(t);var i=a("UMR9"),o=a.n(i),n={name:"wangeditor",data:function(){return{editorContent:""}},props:{content:{type:String},disabled:{default:!1}},watch:{content:function(e,t){this.wEditor.txt.html(e)}},methods:{getContent:function(){return this.wEditor.txt.html()},setContent:function(){this.wEditor.txt.html(this.content)},clearContent:function(){this.wEditor.txt.clear()}},mounted:function(){var e=this,t=this;this.wEditor=new o.a(this.$refs.editor);var a=this.wEditor;a.config.customUploadImg=function(e,a){var i=new FormData;i.append("file",e[0]),t.$request.upload(i).then((function(e){a(e.data.data.split(",")[1])}))},a.config.uploadImgServer="http://47.118.43.170:8080/api/cos/upload",a.config.onchange=function(t){e.editorContent=t},a.create(),a.txt.html(this.content),this.disabled?a.$textElem.attr("contenteditable",!1):a.$textElem.attr("contenteditable",!0)}},r=a("SsL+"),s=Object(r.a)(n,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{ref:"editor",staticStyle:{"text-align":"left"}})])}),[],!1,null,"69fd3103",null);t.default=s.exports},VmGR:function(e,t,a){"use strict";a("4A7B")},k6n4:function(e,t,a){var i=a("fCtq"),o=a("zpmP"),n=a("mf7F");e.exports=function(e,t){var a=(o.Object||{})[e]||Object[e],r={};r[e]=t(a),i(i.S+i.F*n((function(){a(1)})),"Object",r)}},kq7F:function(e,t,a){"use strict";a.r(t);var i=a("EPZ6"),o=a.n(i),n={components:{wangEditor:a("EiDx").default},data:function(){return{title:"",activeName:"first",header:{"Content-Type":"multipart/form-data"},dialogImageUrl:"",dialogVisible:!1,form:{newsImagesCodes:void 0,newsVideoCodes:void 0,newsTitle:void 0,newsType:void 0,newsContent:void 0,userCode:JSON.parse(localStorage.getItem("userInfo")).userCode},newsTypeMap:[],rules:{newsTitle:[{required:!0,message:"标题不能为空",trigger:"change"}],newsType:[{required:!0,message:"新闻类型不能为空",trigger:"change"}]}}},created:function(){var e=this;this.$request.findAlleuemsNews().then((function(t){for(var a=[],i=t.data.data,n=0;n<o()(i.newsTypeMap).length;n++){var r={};r.value=o()(i.newsTypeMap)[n],r.label=i.newsTypeMap[o()(i.newsTypeMap)[n]],a.push(r)}e.newsTypeMap=a,e.newsTypeMap.forEach((function(t){t.value==e.form.newsType&&(e.title=t.label)}))}))},mounted:function(){this.$route.params.code?(localStorage.setItem("newsType",this.$route.params.code),this.form.newsType=this.$route.params.code):this.form.newsType=localStorage.getItem("newsType")},methods:{handleRemove:function(e,t){console.log(e,t)},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},uploadVadioFile:function(e){var t=this,a=new FormData;console.log(e),a.append("file",e.file),this.$request.upload(a).then((function(e){t.form.newsVideoCodes=e.data.data.split(",")[0]}))},uploadSectionFile:function(e){var t=this,a=new FormData;a.append("file",e.file),this.$request.upload(a).then((function(e){t.form.newsImagesCodes=e.data.data.split(",")[0]}))},getLocalImg:function(e){var t="";null!=window.createObjectURL?t=window.createObjectURL(e.raw):null!=window.URL?t=window.URL.createObjectURL(e.raw):null!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e.raw)),this.dialogImageUrl=t,this.dialogVisible=!0},cancel:function(e){this.$router.go(-1),this.$store.dispatch("removeTab",{tabItem:e,fullPath:this.$route.fullPath,router:this.$router})},submitForm:function(e,t){var a=this;if(""!=this.$refs.wangeditor.editorContent){this.form.newsContent=this.$refs.wangeditor.editorContent;var i=this;this.$refs.form.validate((function(o){o&&(0==t?a.$request.saveNews(a.form).then((function(t){200===t.data.status?(a.msgSuccess("新增成功"),i.$router.go(-1),i.$store.dispatch("removeTab",{tabItem:e,fullPath:a.$route.fullPath,router:a.$router})):a.$message.error(t.data.msg)})):1==t&&a.$request.publishNews(a.form).then((function(t){200===t.data.status?(a.msgSuccess("新增成功"),i.$router.go(-1),i.$store.dispatch("removeTab",{tabItem:e,fullPath:a.$route.fullPath,router:a.$router})):a.$message.error(t.data.msg)})))}))}else this.$message.error("内容不能为空")}}},r=(a("VmGR"),a("SsL+")),s=Object(r.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contant"},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"图文类型：",prop:"newsType"}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择"},model:{value:e.form.newsType,callback:function(t){e.$set(e.form,"newsType",t)},expression:"form.newsType"}},e._l(e.newsTypeMap,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:e.title+"标题:",prop:"newsTitle"}},[a("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.form.newsTitle,callback:function(t){e.$set(e.form,"newsTitle",t)},expression:"form.newsTitle"}})],1),e._v(" "),a("el-form-item",[a("el-tabs",{attrs:{stretch:!1},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"通知封面上传",name:"first"}},[a("el-upload",{ref:"upload",attrs:{action:"uploadUrl","list-type":"picture-card",limit:1,"http-request":e.uploadSectionFile,headers:e.header,"with-credentials":!0,accept:"image/png, image/gif, image/jpg, image/jpeg","on-preview":e.getLocalImg}},[a("i",{staticClass:"el-icon-plus"})])],1),e._v(" "),a("el-tab-pane",{attrs:{label:"内容视频上传",name:"fourth"}},[a("el-upload",{ref:"uploadVadio",attrs:{action:"uploadUrl","list-type":"picture-card",limit:1,"http-request":e.uploadVadioFile,headers:e.header,"with-credentials":!0}},[a("i",{staticClass:"el-icon-plus"})])],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"内容详情:",prop:"userSex"}},[a("wang-editor",{ref:"wangeditor"})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(t){return e.cancel(e.$store.getters.rightNav)}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm(e.$store.getters.rightNav,0)}}},[e._v("不发布提交")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm(e.$store.getters.rightNav,1)}}},[e._v("发布提交")])],1),e._v(" "),a("el-dialog",{attrs:{width:"600px",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1)}),[],!1,null,"747e1ef6",null);t.default=s.exports},xSEk:function(e,t,a){a("8DEy"),e.exports=a("zpmP").Object.keys}}]);
//# sourceMappingURL=5.2460c220af4aeb5d24ec.js.map