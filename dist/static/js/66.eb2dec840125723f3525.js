(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{LLCx:function(t,e,s){},Uif5:function(t,e,s){"use strict";s("LLCx")},zMsJ:function(t,e,s){"use strict";s.r(e);var o=s("6ZY3"),i=s.n(o),n={data:function(){return{isAnswer:!1,updateIsAnswer:!1,questionInfo:{questionOrder:void 0,questionName:void 0,answerType:void 0,groupCode:void 0,surveyCode:0x39288c7f0a000},groupType:"",updateInfo:{},update:{id:void 0,show:!1},open:!1,addGroupOpen:!1,addGroupInfo:{groupName:void 0,optionList:[{displayOrder:0,optionName:void 0}]},title:"",addGroupTitle:"",tableData:[],questionData:[],dictList:[],groupList:void 0,column:[{prop:"groupName",label:"选项组名称",width:"140"},{prop:"optionCodes",label:"选项"}]}},watch:{"questionInfo.answerType":{handler:function(t,e){2==t?(this.isAnswer=!0,this.groupList=void 0,this.questionInfo.groupCode=void 0):this.isAnswer=!1},deep:!0,immediate:!0},"updateInfo.answerType":{handler:function(t,e){2==t?(this.updateIsAnswer=!0,this.updateInfo.optionList=[],this.updateInfo.groupCode=void 0):this.updateIsAnswer=!1},deep:!0,immediate:!0}},created:function(){this.$route.params.code?(localStorage.setItem("surveyCode",this.$route.params.code),this.questionInfo.surveyCode=this.$route.params.code):this.questionInfo.surveyCode=localStorage.getItem("surveyCode")},mounted:function(){var t=this;this.$request.surveyFindEnum().then((function(e){t.dictList=e.data.data})),this.getList(),this.getQuestionList()},methods:{submitGroup:function(){var t=this;this.$request.surveyGroupCreate(this.addGroupInfo).then((function(e){200==e.data.status?(t.addGroupOpen=!1,t.getList(),t.$message.success("新增成功")):t.$message.error(e.data.msg)}))},cancelGroup:function(){this.addGroupOpen=!1},goBack:function(t,e){"submit"==t&&this.$message.success("提交成功"),this.$router.go(-1),this.$store.dispatch("removeTab",{tabItem:e,fullPath:this.$route.fullPath,router:this.$router})},addItem:function(){this.addGroupInfo.optionList.push({displayOrder:this.addGroupInfo.optionList.length,optionName:void 0})},addGroup:function(){this.addGroupOpen=!0,this.addGroupTitle="自定义选项组",this.addGroupInfo={groupName:void 0,optionList:[{displayOrder:0,optionName:void 0}]}},getList:function(){var t=this;this.$request.surveyGroupList().then((function(e){200==e.data.status?t.tableData=e.data.data:t.$message.error(e.data.msg)}))},getQuestionList:function(){var t=this;this.$request.surveyQuestionList(this.questionInfo.surveyCode).then((function(e){200==e.data.status?t.questionData=e.data.data:t.$message.error(e.data.msg)}))},chooseGroup:function(t){this.open=!0,this.title="选择选项组",this.groupType=t},handleChoose:function(t){if("add"==this.groupType)this.questionInfo.groupCode=t.groupCode,this.groupList=t.optionCodes.split(",");else{this.updateInfo.groupCode=t.groupCode;var e=[];t.optionCodes.split(",").map((function(t){e.push({optionName:t})})),this.updateInfo.optionList=e}this.open=!1},deleteGroup:function(t){var e=this,s=t.groupCode;this.$confirm("是否确认删除该选项组?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$request.surveyDelGroup(s).then((function(){e.getList(),e.msgSuccess("删除成功")}))})).catch((function(){}))},cancel:function(){this.questionInfo=i()(this.questionInfo,{questionOrder:void 0,questionName:void 0,answerType:void 0,groupCode:void 0}),this.groupList=void 0},updateCancel:function(){this.update={id:void 0,show:!1}},questionUpdate:function(t){this.update.show?this.$message.error("请先保存上一个修改的问题"):(this.update={id:t.id,show:!0},this.updateInfo=t)},deleteQuestion:function(t){var e=this,s=t.id;this.$confirm("是否确认删除该题目?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$request.surveyDelQuestion(s).then((function(){e.getQuestionList(),e.msgSuccess("删除成功")}))})).catch((function(){}))},save:function(){var t=this;this.$request.surveyQuestionCreate(this.questionInfo).then((function(e){200==e.data.status?(t.$message.success("保存成功"),t.cancel(),t.getQuestionList()):t.$message.error(e.data.msg)}))},updateSave:function(){var t=this;this.$request.surveyQuestionUpdate(this.updateInfo).then((function(e){200==e.data.status?(t.$message.success("保存成功"),t.updateCancel(),t.getQuestionList()):t.$message.error(e.data.msg)}))}}},a=(s("Uif5"),s("SsL+")),u=Object(a.a)(n,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"contant"},[s("div",{staticClass:"accomplish"},[t._l(t.questionData,(function(e,o){return s("div",{key:o,staticClass:"accomplish-list"},[t.update.id==e.id&&t.update.show?s("div",[s("div",{staticClass:"addquestion"},[s("div",{staticStyle:{display:"inline-block",width:"10%"}},[s("el-input",{attrs:{placeholder:"题目序号"},model:{value:t.updateInfo.questionOrder,callback:function(e){t.$set(t.updateInfo,"questionOrder",e)},expression:"updateInfo.questionOrder"}})],1),t._v(" "),s("div",{staticStyle:{display:"inline-block",width:"74%","margin-bottom":"10px","margin-top":"10px"}},[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:t.updateInfo.questionName,callback:function(e){t.$set(t.updateInfo,"questionName",e)},expression:"updateInfo.questionName"}})],1),t._v(" "),s("div",{staticStyle:{display:"inline-block",width:"15%"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:t.updateInfo.answerType,callback:function(e){t.$set(t.updateInfo,"answerType",e)},expression:"updateInfo.answerType"}},t._l(t.dictList.answerTypeEnum,(function(t){return s("el-option",{key:t.type,attrs:{label:t.value,value:t.type}})})),1)],1),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.updateIsAnswer,expression:"!updateIsAnswer"}],attrs:{size:"small",type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.chooseGroup("update")}}},[t._v("选择选项组")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.updateIsAnswer,expression:"!updateIsAnswer"}],staticClass:"choose"},[t._l(t.updateInfo.optionList,(function(e,o){return s("el-radio",{key:o,attrs:{label:"1"}},[t._v(t._s(e.optionName))])})),t._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"text"},on:{click:function(e){return t.chooseGroup("update")}}},[t._v("重新选择")])],2),t._v(" "),s("div",{staticClass:"bottom-btn"},[s("el-button",{attrs:{size:"small"},on:{click:t.updateCancel}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.updateSave}},[t._v("保 存")])],1)],1)]):s("div",[s("p",[s("span",[t._v(t._s(e.questionOrder)+",")]),s("span",[t._v(t._s(e.questionName)+"("+t._s(e.answerTypeStr)+")")])]),t._v(" "),s("div",{staticClass:"button"},[s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.questionUpdate(e)}}},[t._v("修改")]),s("el-button",{staticStyle:{color:"#f56c6c"},attrs:{type:"text"},on:{click:function(s){return t.deleteQuestion(e)}}},[t._v("删除")])],1),t._v(" "),s("div",{staticClass:"choose"},t._l(e.optionList,(function(e,o){return s("el-radio",{key:o,attrs:{label:"1"}},[t._v(t._s(e.optionName))])})),1)])])})),t._v(" "),s("div",{staticClass:"addquestion"},[s("p",[t._v("新增问卷题目")]),t._v(" "),s("div",{staticStyle:{display:"inline-block",width:"10%"}},[s("el-input",{attrs:{placeholder:"题目序号"},model:{value:t.questionInfo.questionOrder,callback:function(e){t.$set(t.questionInfo,"questionOrder",e)},expression:"questionInfo.questionOrder"}})],1),t._v(" "),s("div",{staticStyle:{display:"inline-block",width:"74%","margin-bottom":"10px","margin-top":"10px"}},[s("el-input",{staticClass:"input-with-select",attrs:{placeholder:"题目"},model:{value:t.questionInfo.questionName,callback:function(e){t.$set(t.questionInfo,"questionName",e)},expression:"questionInfo.questionName"}})],1),t._v(" "),s("div",{staticStyle:{display:"inline-block",width:"15%"}},[s("el-select",{attrs:{placeholder:"题目类型"},model:{value:t.questionInfo.answerType,callback:function(e){t.$set(t.questionInfo,"answerType",e)},expression:"questionInfo.answerType"}},t._l(t.dictList.answerTypeEnum,(function(t){return s("el-option",{key:t.type,attrs:{label:t.value,value:t.type}})})),1)],1),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.isAnswer,expression:"!isAnswer"}],attrs:{size:"small",type:"text",icon:"el-icon-plus"},on:{click:function(e){return t.chooseGroup("add")}}},[t._v("选择选项组")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isAnswer,expression:"!isAnswer"}],staticClass:"choose"},[t._l(t.groupList,(function(e,o){return s("el-radio",{key:o,attrs:{label:"1"}},[t._v(t._s(e))])})),t._v(" "),t.groupList?s("el-button",{staticStyle:{float:"right"},attrs:{size:"small",type:"text"},on:{click:function(e){return t.chooseGroup("add")}}},[t._v("重新选择")]):t._e()],2),t._v(" "),s("div",{staticClass:"bottom-btn"},[s("el-button",{attrs:{size:"small"},on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)],1)],2),t._v(" "),s("div",{staticClass:"flooter"},[s("el-button",{on:{click:function(e){return t.goBack("next",t.$store.getters.rightNav)}}},[t._v("上一步")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.goBack("submit",t.$store.getters.rightNav)}}},[t._v("提交")])],1),t._v(" "),s("el-dialog",{attrs:{title:t.title,visible:t.open,width:"700px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[s("div",{staticClass:"button"},[s("el-row",{staticClass:"operations-row",attrs:{gutter:10}},[s("el-col",{attrs:{span:1.5}},[s("el-button",{attrs:{type:"text",icon:"el-icon-plus",size:"mini"},on:{click:t.addGroup}},[t._v("自定义选项组")])],1)],1)],1),t._v(" "),s("el-table",{attrs:{"header-cell-style":{background:"#F4F4F4"},data:t.tableData}},[t._l(t.column,(function(t,e){return s("el-table-column",{key:e,attrs:{prop:t.prop,label:t.label,width:t.width?t.width:""}})})),t._v(" "),s("el-table-column",{attrs:{width:"100px",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(s){return t.handleChoose(e.row)}}},[t._v("选择")]),t._v(" "),s("el-button",{staticStyle:{color:"#f56c6c"},attrs:{size:"mini",type:"text"},on:{click:function(s){return t.deleteGroup(e.row)}}},[t._v("删除")])]}}])})],2)],1),t._v(" "),s("el-dialog",{attrs:{title:t.addGroupTitle,visible:t.addGroupOpen,width:"700px","append-to-body":""},on:{"update:visible":function(e){t.addGroupOpen=e}}},[s("div",{staticClass:"add-box"},[s("p",[t._v("注意：选项组添加顺序即为显示顺序")]),t._v(" "),s("div",{staticClass:"group-title"},[t._v("\n        选项组名称："),s("el-input",{staticClass:"demo-input-label",attrs:{size:"small",placeholder:"请输入内容"},model:{value:t.addGroupInfo.groupName,callback:function(e){t.$set(t.addGroupInfo,"groupName",e)},expression:"addGroupInfo.groupName"}})],1),t._v(" "),s("div",{staticClass:"group-item"},[t._l(t.addGroupInfo.optionList,(function(e,o){return s("el-input",{key:o,staticClass:"demo-input-item",attrs:{size:"small",placeholder:"请输入选项"},model:{value:e.optionName,callback:function(s){t.$set(e,"optionName",s)},expression:"item.optionName"}})})),t._v(" "),s("el-button",{attrs:{type:"text",icon:"el-icon-plus",size:"mini"},on:{click:t.addItem}},[t._v("自定义选项")])],2)]),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:t.cancelGroup}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.submitGroup}},[t._v("确 定")])],1)])],1)}),[],!1,null,"03076f56",null);e.default=u.exports}}]);
//# sourceMappingURL=66.eb2dec840125723f3525.js.map