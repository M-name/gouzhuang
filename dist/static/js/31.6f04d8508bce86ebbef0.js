(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{"/vbE":function(e,t,a){"use strict";var r=a("lQOv");a.n(r).a},GQeE:function(e,t,a){e.exports={default:a("iq4v"),__esModule:!0}},ITS2:function(e,t,a){"use strict";a.r(t);var r=a("GQeE"),o=a.n(r),i={name:"userControl",data:function(){var e=this;return{rules:{managerCode:[{required:!0,message:"完成人未选择",trigger:"change"}],finishTime:[{required:!0,message:"完成时间未选择",trigger:"change"}]},form:{},staffList:[],open:!1,title:"",loading:!1,tableOptions:{stripe:!1,highlightCurrentRow:!0,multiSelect:!1},tableOperations:[{label:"查看",icon:"el-icon-tickets",handler:function(t){return e.handleUpdate(t)}},{label:"完成",icon:"el-icon-tickets",handler:function(t){return e.handleFinish(t)}},{label:"派单",icon:"iconfont icon-assign",handler:function(t){return e.handlePayout(t)},isShow:function(e){return e.repaireStatus<30}}],commonSearchList:[{prop:"buildingCode",label:"房屋编码 "},{prop:"userName",label:" 报修用户"},{prop:"mobile",label:"用户手机号"},{prop:"repaireCode",label:"工单编号"},{prop:"repaireStatus",label:"处理状态",type:"select",options:[]},{prop:"managerName",label:"维修员工"}],column:[{prop:"createTime",label:"提交时间 "},{prop:"repaireCode",label:"工单编号",widht:"180"},{prop:"repairType",label:"报修类型",widht:"180"},{prop:"buildingCodeStr",label:"报修房屋"},{prop:"userName",label:"联系方式",render:function(e,t){return e("div",[t.row.userName+"/ "+t.row.mobile])}},{prop:"repaireStatus",label:"处理状态",formatter:function(t,a,r){return e.selectDictLabel(e.roleStatus,t.repaireStatus)}},{prop:"publishTypeValue",label:"派发策略"},{prop:"managerName",label:"维修员工"}],tableData:[],total:0,roleStatus:[],params:{page:1,pageSize:20,buildingCode:void 0,userName:void 0,mobile:void 0,repaireStatus:void 0,managerName:void 0}}},created:function(){var e=this;this.$request.alarmGetStaff().then((function(t){for(var a=t.data.data,r=[],i=0;i<o()(a).length;i++){var n={label:"",options:[]};n.label=o()(a)[i];for(var s=0;s<a[o()(a)[i]].length;s++)n.options.push({value:a[o()(a)[i]][s].userCode,label:a[o()(a)[i]][s].realName});r.push(n)}e.staffList=r})),this.$request.findRepairAlleuems().then((function(t){for(var a=[],r=t.data.data,o=0;o<r.repaireProgressEnum.length;o++){var i={};i.value=r.repaireProgressEnum[o].type,i.label=r.repaireProgressEnum[o].value,a.push(i)}e.roleStatus=a,e.commonSearchList.forEach((function(e){"select"==e.type&&"repaireStatus"==e.prop&&(e.options=a)}))})),this.getList()},methods:{submitForm:function(){var e=this,t=this;this.$refs.form.validate((function(a){a&&t.$request.repairProcessed(e.form).then((function(a){200==a.data.status?(t.$message.success("提交成功"),e.open=!1,e.getList(),e.$refs.form.resetFields()):(e.open=!1,t.$message.error(a.data.msg))}))}))},reset:function(){this.form={managerCode:"",remark:"",repaireCode:"",finishTime:void 0}},cancel:function(){this.open=!1,this.reset(),this.$refs.form.resetFields()},selectDictLabel:function(e,t){var a=[];return o()(e).map((function(r){if(e[r].value==""+t)return a.push(e[r].label),!1})),a.join("")},handleQuery:function(){this.params.page=1,this.getList()},resetQuery:function(){this.params={page:1,pageSize:20,buildingCode:void 0,userName:void 0,mobile:void 0,repaireStatus:void 0,managerName:void 0},this.handleQuery()},handleFinish:function(e){this.reset(),this.open=!0,this.title="订单完成",this.form.repaireCode=e.repaireCode},handleUpdate:function(e){this.$router.push({path:"/detailInfo",name:"detailInfo",params:{type:0,code:e.repaireCode}})},handlePayout:function(e){this.$router.push({path:"/detailInfo",name:"detailInfo",params:{type:1,code:e.repaireCode}})},getList:function(){var e=this;this.loading=!0,this.$request.getRepairProcessList(this.params).then((function(t){200===t.data.status?(e.tableData=t.data.data.rows,e.total=t.data.data.records,e.params.page=t.data.data.page,e.loading=!1):(that.$message.error(t.data.msg),e.loading=!1)}))}}},n=(a("/vbE"),a("KHd+")),s=Object(n.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticStyle:{"padding-right":"20px",background:"#fff"}},[a("CommonSearch",{attrs:{queryParams:e.params,searchList:e.commonSearchList},on:{resetQuery:e.resetQuery,handleQuery:e.handleQuery,"update:queryParams":function(t){e.params=t},"update:query-params":function(t){e.params=t}}})],1),e._v(" "),a("div",{staticClass:"operation"},[a("CommonTable",{attrs:{total:e.total,loading:e.loading,defColumns:e.column,dataList:e.tableData,options:e.tableOptions,page:e.params.page,limit:e.params.pageSize,operations:e.tableOperations},on:{pagination:e.getList,"update:page":function(t){return e.$set(e.params,"page",t)},"update:limit":function(t){return e.$set(e.params,"pageSize",t)}}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,"before-close":e.cancel,visible:e.open,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"完成人：",prop:"managerCode"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.managerCode,callback:function(t){e.$set(e.form,"managerCode",t)},expression:"form.managerCode"}},e._l(e.staffList,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"完成时间:",prop:"finishTime"}},[a("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},model:{value:e.form.finishTime,callback:function(t){e.$set(e.form,"finishTime",t)},expression:"form.finishTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)}),[],!1,null,"5a6776b9",null);t.default=s.exports},Mqbl:function(e,t,a){var r=a("JB68"),o=a("w6GO");a("zn7N")("keys",(function(){return function(e){return o(r(e))}}))},iq4v:function(e,t,a){a("Mqbl"),e.exports=a("WEpk").Object.keys},lQOv:function(e,t,a){},zn7N:function(e,t,a){var r=a("Y7ZC"),o=a("WEpk"),i=a("KUxP");e.exports=function(e,t){var a=(o.Object||{})[e]||Object[e],n={};n[e]=t(a),r(r.S+r.F*i((function(){a(1)})),"Object",n)}}}]);
//# sourceMappingURL=31.6f04d8508bce86ebbef0.js.map