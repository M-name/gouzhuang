(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{GQeE:function(e,t,a){e.exports={default:a("iq4v"),__esModule:!0}},Hulq:function(e,t,a){"use strict";var o=a("X1cq");a.n(o).a},Mqbl:function(e,t,a){var o=a("JB68"),i=a("w6GO");a("zn7N")("keys",(function(){return function(e){return i(o(e))}}))},Wkc3:function(e,t,a){"use strict";a.r(t);var o=a("GQeE"),i=a.n(o),r=a("YEIV"),s=a.n(r),n={name:"userControl",data:function(){var e,t=this;return{chooseShow:!1,radio:"BARCODE_PAY",peopleRadio:"USER",form:{},code:"",open:!1,tipOpen:!1,title:"",loading:!1,chooseLoading:!1,single:!0,multiple:!0,billList:[],publishStatusMap:[],rules:{payer:[{required:!0,message:"支付住户未选择",trigger:"blur"}]},tableOptions:{stripe:!1,highlightCurrentRow:!0,multiSelect:!0},chooseTableOptions:{stripe:!1,highlightCurrentRow:!0,multiSelect:!1,border:!1},chooseTableOperations:[{label:"选择",icon:"el-icon-edit",handler:function(e){return t.choose(e)}}],tableOperations:[],commonSearchList:[{prop:"userName",label:"住户姓名"},{prop:"buildingCode",label:"房屋编码"},{prop:"mobile",label:"手机号"},{prop:"certificateCode",label:"证件号码"},{prop:"parkingCode",label:"车位编码"},{prop:"paymentStatus",label:"账单状态",type:"select",options:[{value:3,label:"待支付"},{value:4,label:"已支付"}]},{prop:"feeName",label:"费用类别",type:"select",options:[]},{prop:"orderYear",label:"账单年度"},{prop:"times",label:"支付时间段",type:"datePicker"}],chooseSearchList:[{prop:"buildingCode",label:"房间编码"},{prop:"userName",label:"用户姓名"},{prop:"certificateCode",label:"身份证号"},{prop:"mobile",label:"电话号码"},{prop:"hao",label:"门禁号"},{prop:"liveType",label:"证件类型",type:"select",options:[]},{prop:"liveStatus",label:"居住状态",type:"select",options:[]},{prop:"liveTypeId",label:"住户类型",type:"select",options:[]}],column:[{prop:"orderYear",label:"账单年度"},{prop:"serviceEndTime",label:"账单周期",render:function(e,t){return e("div",[t.row.serviceStartTime+"~"+t.row.serviceEndTime])}},{prop:"buildingCode",label:"房屋编码"},{prop:"buildingArea",label:"房屋面积(m²)",width:"160"},{prop:"userName",label:"住户姓名"},{prop:"mobile",label:"手机号"},{prop:"certificateCode",label:"证件号码"},{prop:"parkingCode",label:"车位编码"},{prop:"feeName",label:"费用名称"},{prop:"orderAmount",label:"应支付(元)"},{prop:"discountAmount",label:"优惠金额(元)"},{prop:"paidAmount",label:"实际已付(元)"},{prop:"paymentStatus",label:"账单状态",formatter:function(e,a,o){return t.selectDictLabel(t.payDict,e.paymentStatus)}},{prop:"createTime",label:"生成日期"}],chooseColumn:[{prop:"userName",label:"用户姓名"},{prop:"certificateTypeIdStr",label:"证件类型"},{prop:"certificateCode",label:"证件号码"},{prop:"userSexStr",label:"性别"},{prop:"contactMethod",label:"联系人电话"},{prop:"mobile",label:"电话"},{prop:"liveStatusStr",label:"居住状态"}],payDict:[],tableData:[],chooseTableData:[],total:0,chooseTotal:0,dicList:[],userInfo:{name:"",code:""},ids:[],params:{page:1,pageSize:20,paymentStatus:void 0,userName:void 0,buildingCode:void 0,mobile:void 0,certificateCode:void 0,parkingCode:void 0,orderYear:void 0,times:void 0,endTime:void 0,startTime:void 0},chooseParams:(e={page:1,pageSize:10,newsTitle:void 0,publishStatus:void 0},s()(e,"newsTitle",void 0),s()(e,"publishStatus",void 0),s()(e,"newsTitle",void 0),s()(e,"publishStatus",void 0),s()(e,"newsTitle",void 0),s()(e,"publishStatus",void 0),e)}},created:function(){var e=this;this.$request.orderGetEnum().then((function(t){e.dicList=t.data.data,e.dicList.paymentStatusEnum.map((function(t){e.payDict.push({value:t.type,label:t.value})})),e.commonSearchList.forEach((function(t){"select"==t.type&&"feeName"==t.prop&&e.dicList.feeDictSecondEnum.map((function(e){t.options.push({label:e.feeName,value:e.feeName})}))}))})),this.getList(),this.chooseGetList(),window.document.onkeypress=function(t){if("BARCODE_PAY"==e.radio){if(window.event?e.nextCode=t.keyCode:t.which&&(e.nextCode=t.which),13===t.which){if(e.code.length<3)return;return e.parseQRCode(e.code),e.lastCode="",void(e.lastTime="")}e.nextTime=(new Date).getTime(),e.lastTime||e.lastCode||(e.code="",e.code+=t.key),e.lastCode&&e.lastTime&&e.nextTime-e.lastTime>500?e.code=t.key:e.lastCode&&e.lastTime&&(e.code+=t.key),e.lastCode=e.nextCode,e.lastTime=e.nextTime}}},methods:{choose:function(e){var t=this;this.$request.peopleFfindUser({id:e.id,userCode:e.userCode}).then((function(e){200==e.data.status?(t.form.payer=e.data.data.userName,t.form.userCode=e.data.data.userCode,t.chooseShow=!1):that.$message.error(e.data.data)}))},chooseGetList:function(){var e=this;this.chooseLoading=!0,this.$request.detailAll(this.chooseParams).then((function(t){200==t.data.status?(e.chooseTableData=t.data.data.rows,e.chooseTotal=t.data.data.records,e.chooseParams.page=t.data.data.page,e.chooseLoading=!1):e.chooseLoading=!1}))},chooseHandleQuery:function(){this.chooseParams.page=1,this.chooseGetList()},chooseResetQuery:function(){var e;this.chooseParams=(e={page:1,pageSize:10,newsTitle:void 0,publishStatus:void 0},s()(e,"newsTitle",void 0),s()(e,"publishStatus",void 0),s()(e,"newsTitle",void 0),s()(e,"publishStatus",void 0),s()(e,"newsTitle",void 0),s()(e,"publishStatus",void 0),e),this.chooseHandleQuery()},choosePeople:function(){this.chooseShow=!0},payChange:function(e){var t=this;"BARCODE_PAY"==e?(this.form.paymentRemark="",this.form.authCode=void 0,this.$nextTick((function(){t.$refs.input.focus()}))):(this.form.paymentRemark="",this.form.authCode=void 0)},peopleChange:function(e){"USER"==e?(this.form.payer=this.userInfo.name,this.form.userCode=this.userInfo.code):"OTHER"==e&&(this.form.payer=void 0,this.form.userCode=void 0)},selectDictLabel:function(e,t){var a=[];return i()(e).map((function(o){if(e[o].value==""+t)return a.push(e[o].label),!1})),a.join("")},parseQRCode:function(e){this.form.authCode=e},afterPay:function(e){var t=void 0;return"QUERY_WX"==e?this.$request.queryWXPay(this.form.uniformOrderCode).then((function(e){t="SUCCESS"==e.data.data})):this.$request.queryAliPay(this.form.uniformOrderCode).then((function(e){t="SUCCESS"==e.data.data})),t},submitForm:function(){var e=this,t=this;this.$refs.form.validate((function(a){a&&e.$confirm("是否确认支付?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if("BARCODE_PAY"==t.radio){var e=t.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});t.$request.orderPaymentCreatPay(t.form).then((function(a){"SUCCESS"==a.data.data?(t.open=!1,t.$message.success("支付成功"),e.close(),t.getList()):"QUERY_WX"==a.data.data||"QUERY_ALI"==a.data.data?setTimeout((function(){t.afterPay(a.data.data)?(t.$message.success("支付成功"),t.getList(),e.close(),t.open=!1):(t.getList(),t.open=!1,e.close(),t.tipOpen=!0)}),5e3):(t.$message.error(a.data.data||a.data.msg),t.getList(),e.close(),t.open=!1)}))}else"TRANSFER"==t.radio?t.$request.orderPaymentTransferPay(t.form).then((function(e){200==e.data.status?"SUCCESS"!=e.data.data?(t.$message.error(e.data.data),t.getList(),t.open=!1):(t.open=!1,t.$message.success("支付成功"),t.getList()):(t.$message.error(e.data.data),t.getList(),t.open=!1)})):t.$request.orderPaymentCashPay(t.form).then((function(e){200==e.data.status?"SUCCESS"!=e.data.data?(t.$message.error(e.data.data),t.getList(),t.open=!1):(t.open=!1,t.$message.success("支付成功"),t.getList()):(t.$message.error(e.data.data),t.getList(),t.open=!1)}))})).catch((function(){}))}))},importExcel:function(){this.$request.orderDownloadExcel(this.params)},handleSelectionChange:function(e){this.billList=e,this.ids=e.map((function(e){return e.orderCode})),this.single=1!=e.length,this.multiple=!e.length},handleQuery:function(){this.params.page=1,this.params.times?(this.params.startTime=this.params.times[0],this.params.endTime=this.params.times[1]):(this.params.startTime=void 0,this.params.endTime=void 0),this.getList()},resetQuery:function(){this.params={page:1,pageSize:20,paymentStatus:void 0,userName:void 0,buildingCode:void 0,mobile:void 0,certificateCode:void 0,parkingCode:void 0,orderYear:void 0,times:void 0,endTime:void 0,startTime:void 0},this.handleQuery()},addList:function(){var e=this;this.radio="BARCODE_PAY",this.$request.orderPaymentCreateOrder(this.ids).then((function(t){200==t.data.status?(e.title="确认缴费",t.data.data.paymentRemark=void 0,e.form=t.data.data,e.userInfo.name=t.data.data.payer,e.userInfo.code=t.data.data.userCode,e.open=!0,e.$nextTick((function(){e.$refs.input.focus()}))):e.$message.error(t.data.msg)}))},cancel:function(){this.open=!1},getList:function(){var e=this;this.loading=!0,this.params.orderYear&&(this.params.orderYear=Number(this.params.orderYear)),this.$request.orderFindAll(this.params).then((function(t){200==t.data.status?(e.tableData=t.data.data.rows,e.total=t.data.data.records,e.params.page=t.data.data.page,e.loading=!1):(e.loading=!1,e.$message.error(t.data.msg))}))}}},l=(a("Hulq"),a("KHd+")),d=Object(l.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticStyle:{"padding-right":"20px",background:"#fff"}},[a("CommonSearch",{attrs:{queryParams:e.params,searchList:e.commonSearchList},on:{resetQuery:e.resetQuery,handleQuery:e.handleQuery,"update:queryParams":function(t){e.params=t},"update:query-params":function(t){e.params=t}}})],1),e._v(" "),a("div",{staticClass:"operation"},[a("div",{staticClass:"button"},[a("el-row",{staticClass:"operations-row",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini",disabled:e.multiple},on:{click:e.addList}},[e._v("选中收费")])],1),e._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini"},on:{click:e.importExcel}},[e._v("导出账单Excel")])],1)],1)],1),e._v(" "),a("CommonTable",{attrs:{total:e.total,loading:e.loading,defColumns:e.column,dataList:e.tableData,options:e.tableOptions,page:e.params.page,limit:e.params.pageSize,operations:e.tableOperations},on:{pagination:e.getList,"update:page":function(t){return e.$set(e.params,"page",t)},"update:limit":function(t){return e.$set(e.params,"pageSize",t)},"selection-change":e.handleSelectionChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.title,"before-close":e.cancel,visible:e.open,width:"700px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"支付详情:",prop:"paymentDetail"}},[a("el-input",{attrs:{disabled:"",placeholder:"请输入"},model:{value:e.form.paymentDetail,callback:function(t){e.$set(e.form,"paymentDetail",t)},expression:"form.paymentDetail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"支付金额:",prop:"amountPaid"}},[a("el-input",{attrs:{disabled:"",placeholder:"请输入"},model:{value:e.form.amountPaid,callback:function(t){e.$set(e.form,"amountPaid",t)},expression:"form.amountPaid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"支付方式:"}},[a("el-radio-group",{on:{change:e.payChange},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio",{attrs:{label:"BARCODE_PAY"}},[e._v("条码支付")]),e._v(" "),a("el-radio",{attrs:{label:"TRANSFER"}},[e._v("转账")]),e._v(" "),a("el-radio",{attrs:{label:"CASH"}},[e._v("现金")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"缴费人:"}},[a("el-radio-group",{on:{change:e.peopleChange},model:{value:e.peopleRadio,callback:function(t){e.peopleRadio=t},expression:"peopleRadio"}},[a("el-radio",{attrs:{label:"USER"}},[e._v("户主本人")]),e._v(" "),a("el-radio",{attrs:{label:"OTHER"}},[e._v("非户主本人")])],1)],1),e._v(" "),"BARCODE_PAY"==e.radio?a("el-form-item",{attrs:{label:"条形码:",prop:"authCode"}},[a("el-input",{ref:"input",attrs:{disabled:e.form.authCode,placeholder:"请输入条形码"},model:{value:e.form.authCode,callback:function(t){e.$set(e.form,"authCode",t)},expression:"form.authCode"}})],1):e._e(),e._v(" "),"OTHER"==e.peopleRadio?a("el-form-item",{attrs:{label:"支付住户:",prop:"payer"}},[a("el-input",{staticClass:"elinput",attrs:{disabled:"",placeholder:"请输入住户姓名"},model:{value:e.form.payer,callback:function(t){e.$set(e.form,"payer",t)},expression:"form.payer"}}),e._v(" "),a("el-button",{staticClass:"btn-buka",attrs:{type:"primary"},on:{click:e.choosePeople}},[e._v("选择")])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"支付备注:",prop:"paymentRemark"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.form.paymentRemark,callback:function(t){e.$set(e.form,"paymentRemark",t)},expression:"form.paymentRemark"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{disabled:!e.form.authCode&&"BARCODE_PAY"==e.radio,type:"primary"},on:{click:e.submitForm}},[e._v("支 付")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"提示",visible:e.tipOpen,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.tipOpen=t}}},[a("el-form",{attrs:{"label-width":"120px"}},[a("el-form-item",{attrs:{label:"提示:"}},[a("span",[e._v("订单支付错误请在"),a("span",{staticStyle:{color:"#fead3f"}},[e._v("15分钟")]),e._v("后前往撤销")])]),e._v(" "),a("el-form-item",{attrs:{label:"订单编号:"}},[a("span",{staticStyle:{color:"#fe6768"}},[e._v(e._s(e.form.uniformOrderCode?e.form.uniformOrderCode:""))])])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"所有人选择",width:"800px",visible:e.chooseShow},on:{"update:visible":function(t){e.chooseShow=t}}},[a("div",{staticStyle:{"margin-top":"-20px"}},[a("CommonSearch",{attrs:{queryParams:e.chooseParams,searchList:e.chooseSearchList},on:{resetQuery:e.chooseResetQuery,handleQuery:e.chooseHandleQuery,"update:queryParams":function(t){e.chooseParams=t},"update:query-params":function(t){e.chooseParams=t}}})],1),e._v(" "),a("CommonTable",{attrs:{total:e.chooseTotal,loading:e.chooseLoading,tooltipShow:!0,defColumns:e.chooseColumn,dataList:e.chooseTableData,options:e.chooseTableOptions,page:e.chooseParams.page,limit:e.chooseParams.pageSize,operations:e.chooseTableOperations},on:{pagination:e.chooseGetList,"update:page":function(t){return e.$set(e.chooseParams,"page",t)},"update:limit":function(t){return e.$set(e.chooseParams,"pageSize",t)}}})],1)],1)}),[],!1,null,"e47b0458",null);t.default=d.exports},X1cq:function(e,t,a){},iq4v:function(e,t,a){a("Mqbl"),e.exports=a("WEpk").Object.keys},zn7N:function(e,t,a){var o=a("Y7ZC"),i=a("WEpk"),r=a("KUxP");e.exports=function(e,t){var a=(i.Object||{})[e]||Object[e],s={};s[e]=t(a),o(o.S+o.F*r((function(){a(1)})),"Object",s)}}}]);
//# sourceMappingURL=25.f5b45a0174683f08d801.js.map