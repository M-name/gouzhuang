(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{"5mK2":function(e,t,a){"use strict";a("j+wG")},"8DEy":function(e,t,a){var r=a("MhL/"),n=a("S5+y");a("k6n4")("keys",(function(){return function(e){return n(r(e))}}))},EPZ6:function(e,t,a){e.exports={default:a("xSEk"),__esModule:!0}},W9t9:function(e,t,a){"use strict";a.r(t);var r=a("EPZ6"),n=a.n(r),l={name:"filterTable",data:function(){var e=this;return{dictLists:{},staffList:[],loading:!1,commonSearchList:[{prop:"alarmMainCode",label:"告警类型",type:"select",options:[]},{prop:"alarmSubCode",label:"告警子类型",type:"select",options:[]},{prop:"userName",label:"订阅人"}],tableOperations:[{label:"删除",style:{color:"#F56C6C"},icon:"el-icon-delete",handler:function(t){return e.handleDelete(t)}}],tableOptions:{border:!1,stripe:!1,highlightCurrentRow:!0,multiSelect:!0},open:!1,title:"",parentAlarm:[],childAlarm:[],column:[{prop:"alarmMain",label:"告警类型",widht:"180"},{prop:"alarmType",label:"告警类型子类型"},{prop:"userName",label:"订阅人"},{prop:"subscribeTime",label:"订阅时间"},{prop:"subscribeStatus",label:"订阅状态",type:"switch"},{prop:"notifyChannelIds",label:"通知方式"}],ids:[],tableData:[],total:0,form:{},rules:{alarmTypeCode:[{required:!0,message:"告警子类型未选择",trigger:"blur"}],alarmMainCode:[{required:!0,message:"告警类型未选择",trigger:"blur"}],updateBy:[{required:!0,message:"订阅人未选择",trigger:"blur"}],notifyChannelIds:[{required:!0,message:"通知渠道未选择",trigger:"blur"}]},multiple:!0,params:{alarmMainCode:void 0,alarmSubCode:void 0,userName:void 0,page:1,pageSize:20}}},watch:{"params.alarmMainCode":{handler:function(e,t){var a=this;e&&(this.params.alarmSubCode=void 0,this.$request.alarmTypeDictFindSubCode(e).then((function(e){a.commonSearchList.forEach((function(t){"select"==t.type&&"alarmSubCode"==t.prop&&(t.options=[],e.data.data.map((function(e){t.options.push({label:e.alarmTypeName,value:e.alarmTypeCode})})))}))})))},deep:!0,immediate:!0},"form.alarmMainCode":{handler:function(e,t){var a=this;e&&(this.childAlarm=[],this.$request.alarmTypeDictFindSubCode(e).then((function(e){a.childAlarm=e.data.data})))},deep:!0,immediate:!0}},mounted:function(){var e=this;this.$request.alarmTypeSubscribeGetEnum().then((function(t){e.dictLists=t.data.data})),this.$request.alarmGetStaff().then((function(t){for(var a=t.data.data,r=[],l=0;l<n()(a).length;l++){var i={label:"",options:[]};i.label=n()(a)[l];for(var o=0;o<a[n()(a)[l]].length;o++)i.options.push({value:a[n()(a)[l]][o].realName+","+a[n()(a)[l]][o].userCode,label:a[n()(a)[l]][o].realName});r.push(i)}e.staffList=r})),this.$request.alarmTypeDictFindSubCode("00").then((function(t){e.parentAlarm=t.data.data,e.commonSearchList.forEach((function(e){"select"==e.type&&"alarmMainCode"==e.prop&&t.data.data.map((function(t){e.options.push({label:t.alarmTypeName,value:t.alarmTypeCode})}))}))})),this.getList()},methods:{handleSizeChange:function(e){this.params.pageSize=e,this.getList()},handleCurrentChange:function(e){this.s.page=e,this.getList()},changeSwitch:function(e){this.$request.alarmTypeSubscribeUpdate({id:e.id,subscribeStatus:e.subscribeStatus}).then((function(e){}))},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),console.log(e),this.single=1!=e.length,this.multiple=!e.length},handleQuery:function(){this.params.page=1,this.getList()},resetQuery:function(){this.params={alarmMainCode:void 0,alarmSubCode:void 0,userName:void 0,page:1,pageSize:20},this.handleQuery()},handleUpdate:function(e){var t=this;this.reset();var a=e.alarmTypeCode;this.$request.alarmTypeDictFindOne(a).then((function(e){t.form=e.data.data,t.open=!0,t.title="修改告警类型"}))},cancel:function(){this.open=!1,this.reset(),this.$refs.form.resetFields()},submitForm:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.form.userName=e.form.updateBy.split(",")[0],e.form.userCode=Number(e.form.updateBy.split(",")[1]),e.form.updateBy=void 0,e.form.notifyChannelIds=e.form.notifyChannelIds.toString(),e.$request.alarmTypeSubscribeAdd(e.form).then((function(t){200===t.data.status?(e.msgSuccess("新增成功"),e.open=!1,e.getList(),e.$refs.form.resetFields()):e.$message.error(t.data.msg)})))}))},reset:function(){this.form={alarmMainCode:void 0,alarmSubCode:void 0,updateBy:void 0,notifyChannelIds:[],userName:void 0,userCode:void 0}},addList:function(){this.reset(),this.open=!0,this.title="新增告警类型"},getList:function(){var e=this;this.loading=!0,this.$request.alarmTypeSubscribeFindQuery(this.params).then((function(t){200==t.data.status?(e.tableData=t.data.data.rows,e.total=t.data.data.records,e.params.page=t.data.data.page,e.loading=!1):(e.$message.error(t.data.msg),e.loading=!1)}))},handleDelete:function(e){var t=this,a=[];e&&a.push(e.id);var r=a.length>0?a:this.ids;this.$confirm("是否确认删除选中的告警类型?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$request.alarmTypeDictDelete(r).then((function(){200==res.data.status?(t.getList(),t.msgSuccess("删除成功")):t.$message.error(res.data.msg)}))})).catch((function(){}))}}},i=(a("5mK2"),a("SsL+")),o=Object(i.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"contant"},[a("div",{staticStyle:{"padding-right":"20px",background:"#fff"}},[a("CommonSearch",{attrs:{queryParams:e.params,searchList:e.commonSearchList},on:{resetQuery:e.resetQuery,handleQuery:e.handleQuery,"update:queryParams":function(t){e.params=t},"update:query-params":function(t){e.params=t}}})],1),e._v(" "),a("div",{staticClass:"operation"},[a("div",{staticClass:"button"},[a("el-row",{staticClass:"operations-row",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:e.addList}},[e._v("新增")])],1),e._v(" "),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger",disabled:e.multiple},on:{click:function(t){return e.handleDelete()}}},[e._v("删除")])],1)],1)],1),e._v(" "),a("div",{staticClass:"table"},[a("el-table",{attrs:{"header-cell-style":{background:"#F4F4F4"},data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),e._l(e.column,(function(t,r){return a("el-table-column",{key:r,attrs:{prop:t.prop,label:t.label,width:t.width},scopedSlots:e._u([{key:"default",fn:function(r){return["switch"===t.type?a("el-switch",{attrs:{"active-value":0,"inactive-value":1},on:{change:function(t){return e.changeSwitch(r.row)}},model:{value:r.row.subscribeStatus,callback:function(t){e.$set(r.row,"subscribeStatus",t)},expression:"scope.row.subscribeStatus"}}):a("span",[e._v(e._s(r.row[t.prop]))])]}}],null,!0)})})),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticClass:"delet",attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],2),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.params.page,"page-sizes":[10,20,30,40],"page-size":e.params.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)]),e._v(" "),a("el-dialog",{attrs:{title:e.title,"before-close":e.cancel,visible:e.open,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"告警类型：",prop:"alarmMainCode"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.alarmMainCode,callback:function(t){e.$set(e.form,"alarmMainCode",t)},expression:"form.alarmMainCode"}},e._l(e.parentAlarm,(function(e){return a("el-option",{key:e.alarmTypeCode,attrs:{label:e.alarmTypeName,value:e.alarmTypeCode}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"告警子类型：",prop:"alarmTypeCode"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.alarmTypeCode,callback:function(t){e.$set(e.form,"alarmTypeCode",t)},expression:"form.alarmTypeCode"}},e._l(e.childAlarm,(function(e){return a("el-option",{key:e.alarmTypeCode,attrs:{label:e.alarmTypeName,value:e.alarmTypeCode}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"订阅人：",prop:"updateBy"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.updateBy,callback:function(t){e.$set(e.form,"updateBy",t)},expression:"form.updateBy"}},e._l(e.staffList,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"通知渠道:",prop:"notifyChannelIds"}},[a("el-checkbox-group",{model:{value:e.form.notifyChannelIds,callback:function(t){e.$set(e.form,"notifyChannelIds",t)},expression:"form.notifyChannelIds"}},e._l(e.dictLists.templateChannelEnum,(function(t,r){return a("el-checkbox",{key:r,attrs:{label:t.type}},[e._v(e._s(t.value))])})),1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)}),[],!1,null,"41662a5c",null);t.default=o.exports},"j+wG":function(e,t,a){},k6n4:function(e,t,a){var r=a("fCtq"),n=a("zpmP"),l=a("mf7F");e.exports=function(e,t){var a=(n.Object||{})[e]||Object[e],i={};i[e]=t(a),r(r.S+r.F*l((function(){a(1)})),"Object",i)}},xSEk:function(e,t,a){a("8DEy"),e.exports=a("zpmP").Object.keys}}]);
//# sourceMappingURL=10.b2cebecd334c214958e0.js.map