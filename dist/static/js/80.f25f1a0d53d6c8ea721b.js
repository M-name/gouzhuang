(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{"+p4K":function(t,e,s){},C1Tc:function(t,e,s){"use strict";s.r(e);var i={data:function(){var t=this;return{fileImg:[],uploadImgList:[],header:{"Content-Type":"multipart/form-data"},dialogImageUrl:"",dialogVisible:!1,code:0x3ace3ce442000,open:!1,form:{},total:0,loading:!1,dictLists:{},column:[{prop:"businessStatusDesc",label:"处理状态"},{prop:"businessHandleContent",label:"处理描述"},{prop:"createTime",label:"处理时间"},{prop:"createBy",label:"处理客服"},{prop:"imgUrls",label:"进展照片",render:function(e,s){return s.row.imgUrls.length>0?e("p",{style:{color:"#0F8DFF",cursor:"pointer"},on:{click:function(){t.checkImg(s.row)}}},"查看"):e("p","无")}}],repairsDetail:[],tableOptions:{border:!0,stripe:!1,highlightCurrentRow:!0,multiSelect:!1},rules:{businessStatusDesc:[{required:!0,message:"处理状态未选择",trigger:"blur"}]},srcList:[]}},mounted:function(){var t=this;this.$route.params.code?(localStorage.setItem("repairsDetailCode",this.$route.params.code),this.code=this.$route.params.code):this.code=localStorage.getItem("repairsDetailCode"),this.$request.findRepairAlleuems().then((function(e){t.dictLists=e.data.data})),this.getList()},methods:{cancel:function(){this.form={businessStatusDesc:void 0,businessHandleContent:void 0,progressImageCodes:void 0},this.fileImg=[],this.uploadImgList=[]},submitForm:function(t){var e=this;this.$refs.form.validate((function(s){if(s){for(var i=e,a=[],r=0;r<e.uploadImgList.length;r++)a.push(e.uploadImgList[r].code),console.log(e.uploadImgList[r].code);e.form.progressImageCodes=a.toString(),e.dictLists.businessStatusEnum.forEach((function(t){t.value==e.form.businessStatusDesc&&(e.repairsDetail.businessStatus=t.type)})),e.repairsDetail.businessProgressLog=e.form,e.$request.repairUpdateBusiness(e.repairsDetail).then((function(s){200===s.data.status?(e.msgSuccess("提交成功"),i.$router.go(-1),i.$store.dispatch("removeTab",{tabItem:t,fullPath:e.$route.fullPath,router:e.$router})):i.$message.error(s.data.msg)}))}}))},uploadSectionFile:function(t){var e=this,s=new FormData;s.append("file",t.file),this.$request.upload(s).then((function(t){var s={url:t.data.data.split(",")[1]};e.fileImg.push(s),e.uploadImgList.push({code:t.data.data.split(",")[0],url:t.data.data.split(",")[1]})}))},getLocalImg:function(t){var e=t.url;this.dialogImageUrl=e,this.dialogVisible=!0},getLocalImgs:function(t,e){var s=this;this.uploadImgList.forEach((function(e,i){e.url==t.url&&s.uploadImgList.splice(i,1)}))},checkImg:function(t){this.srcList=t.imgUrls,this.open=!0},getList:function(){var t=this;this.$request.repairFindBusiness({businessCode:this.code}).then((function(e){200==e.data.status?t.repairsDetail=e.data.data:t.$message.error(e.data.msg)}))}}},a=(s("omEF"),s("KHd+")),r=Object(a.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[s("i",{staticClass:"el-icon-user icon"}),t._v(" "),s("span",{staticClass:"title"},[t._v("报事处理")]),t._v(" "),s("span",{staticStyle:{color:"#0f8dff"}},[t._v(t._s(t.repairsDetail.businessStatusValue))]),t._v(" "),s("el-divider"),t._v(" "),s("div",{staticClass:"info"},[s("el-form",[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"报事类型"}},[s("p",[t._v(t._s(t.repairsDetail.businessType))])])],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"住户姓名"}},[s("p",[t._v(t._s(t.repairsDetail.userName))])])],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"手机号码"}},[s("p",[t._v(t._s(t.repairsDetail.mobile))])])],1)],1),t._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"楼幢编码"}},[s("p",[t._v(t._s(t.repairsDetail.buildingCode))])])],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"提交方式"}},[s("p",[t._v(t._s(t.repairsDetail.submitMethodValue))])])],1),t._v(" "),s("el-col",{attrs:{span:8}},[s("el-form-item",{attrs:{label:"提交时间"}},[s("p",[t._v(t._s(t.repairsDetail.createTime))])])],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"报事描述"}},[s("div",[t._v(t._s(t.repairsDetail.businessContent))])]),t._v(" "),s("el-form-item",{attrs:{label:"报事照片"}},t._l(t.repairsDetail.imgUrls,(function(e){return s("el-image",{key:e,staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e,"preview-src-list":t.repairsDetail.imgUrls}})})),1)],1)],1),t._v(" "),s("i",{staticClass:"el-icon-user icon"}),t._v(" "),s("span",{staticClass:"title"},[t._v("处理历史")]),t._v(" "),s("el-divider"),t._v(" "),s("div",{staticClass:"table"},[s("CommonTable",{attrs:{defColumns:t.column,dataList:t.repairsDetail.businessProgressLogList,options:t.tableOptions},on:{pagination:t.getList}})],1),t._v(" "),s("i",{staticClass:"el-icon-user icon"}),t._v(" "),s("span",{staticClass:"title"},[t._v("本次处理记录")]),t._v(" "),s("el-divider"),t._v(" "),s("div",{staticClass:"form"},[s("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"140px"}},[s("el-form-item",{attrs:{label:"处理状态：",prop:"businessStatusDesc"}},[s("el-radio-group",{model:{value:t.form.businessStatusDesc,callback:function(e){t.$set(t.form,"businessStatusDesc",e)},expression:"form.businessStatusDesc"}},t._l(t.dictLists.businessStatusEnum,(function(e){return s("el-radio",{key:e.type,attrs:{label:e.value}},[t._v(t._s(e.value))])})),1)],1),t._v(" "),s("el-form-item",{attrs:{label:"处理描述：",prop:"businessHandleContent"}},[s("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入处理描述"},model:{value:t.form.businessHandleContent,callback:function(e){t.$set(t.form,"businessHandleContent",e)},expression:"form.businessHandleContent"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"上传照片：",prop:"progressImageCodes"}},[s("el-upload",{ref:"upload",attrs:{action:"uploadUrl","list-type":"picture-card","http-request":t.uploadSectionFile,headers:t.header,"with-credentials":!0,accept:"image/png, image/gif, image/jpg, image/jpeg","on-preview":t.getLocalImg,"on-remove":t.getLocalImgs,"file-list":t.fileImg}},[s("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1)],1),t._v(" "),s("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"right"}},[s("el-button",{on:{click:t.cancel}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm(t.$store.getters.rightNav)}}},[t._v("确 定")])],1)],1),t._v(" "),s("el-dialog",{attrs:{title:"进展照片查看",visible:t.open},on:{"update:visible":function(e){t.open=e}}},t._l(t.srcList,(function(e){return s("el-image",{key:e,staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e,"preview-src-list":t.srcList}})})),1),t._v(" "),s("el-dialog",{attrs:{width:"600px",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)}),[],!1,null,"34568322",null);e.default=r.exports},omEF:function(t,e,s){"use strict";var i=s("+p4K");s.n(i).a}}]);
//# sourceMappingURL=80.f25f1a0d53d6c8ea721b.js.map