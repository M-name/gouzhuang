(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{HlbW:function(e,t,i){},KKth:function(e,t,i){"use strict";i.r(t);var a={name:"userControl",data:function(){var e=this;return{header:{"Content-Type":"multipart/form-data"},loading:!1,tableOptions:{stripe:!1,highlightCurrentRow:!0,multiSelect:!1},tableOperations:[{label:"发票上传",icon:"iconfont icon-upload",handler:function(t){return e.handleUpdate(t)},isShow:function(e){return!e.invoiceUrl}},{label:"发票作废",style:{color:"#F56C6C"},icon:"iconfont icon-cancel",handler:function(t){return e.cancellation(t)},isShow:function(e){return 2!=e.invoiceStatus}},{label:"发票查看",icon:"el-icon-tickets",handler:function(t){return e.handleCheck(t)},isShow:function(e){return e.invoiceUrl}}],commonSearchList:[{prop:"userName",label:"申请人姓名"},{prop:"invoiceTitle",label:"发票抬头"},{prop:"creditCode",label:"统一社会信用代码"},{prop:"invoiceStatus",label:"开票状态",type:"select",options:[]},{prop:"openType",label:"开票类型",type:"select",options:[],optionValue:"value",optionLabel:"label"},{prop:"times",label:"开票时间段",type:"datePicker"}],open:!1,title:"",column:[{prop:"userName",label:"申请人姓名"},{prop:"applyTime",label:"申请时间",widht:"180"},{prop:"invoiceTitle",label:"发票抬头",widht:"180"},{prop:"creditCode",label:"统一社会信用代码"},{prop:"invoiceStatusStr",label:"开票状态"},{prop:"invoiceAmount",label:"开票金额"},{prop:"openTypeStr",label:"开票类型"},{prop:"invoiceTypeStr",label:"发票类型"},{prop:"bankName",label:"开户行名称"},{prop:"enterpriseAccount",label:"开户账号"},{prop:"enterpriseAddr",label:"注册场所地址"},{prop:"enterprisePhone",label:"注册固定电话"}],rules:{applyCode:[{required:!0,message:"发票编码不能为空",trigger:"change"}],invoiceTime:[{required:!0,message:"开票时间未选择",trigger:"change"}]},tableData:[],total:0,form:{},params:{page:1,pageSize:20,userName:void 0,invoiceTitle:void 0,creditCode:void 0,invoiceStatus:void 0,openType:void 0,invoiceType:void 0,times:void 0,endTime:void 0,startTime:void 0}}},created:function(){var e=this;this.$request.invoiceGetEnum().then((function(t){e.dicList=t.data.data,e.commonSearchList.forEach((function(t){"select"==t.type&&"invoiceStatus"==t.prop&&e.dicList.invoiceStatusEnum.map((function(e){t.options.push({label:e.value,value:e.type})})),"select"==t.type&&"openType"==t.prop&&e.dicList.invoiceTypeEnum.map((function(e){t.options.push({label:e.value,value:e.type})}))}))})),this.getList()},methods:{handleCheck:function(e){window.open(e.invoiceUrl)},cancel:function(){this.open=!1,this.reset(),this.$refs.form.resetFields()},submitForm:function(){var e=this;console.log(this.form),this.form.invoiceUrl?this.$refs.form.validate((function(t){t&&e.$request.invoiceCreate(e.form).then((function(t){200===t.data.status?(e.msgSuccess("上传成功"),e.open=!1,e.getList(),e.$refs.form.resetFields()):(e.open=!1,e.getList(),e.$refs.form.resetFields(),e.$message.error(t.data.msg))}))})):this.$message.error("未上传文件")},reset:function(e){this.form={applyCode:void 0,invoiceTime:void 0,invoiceRemark:void 0,invoiceUrl:void 0,id:void 0}},uploadVadioFile:function(e){var t=this,i=new FormData;console.log(e),i.append("file",e.file),this.$request.upload(i).then((function(e){null!=t.form.invoiceUrl?t.form.invoiceUrl=t.form.invoiceUrl+","+e.data.data.split(",")[1]:t.form.invoiceUrl=e.data.data.split(",")[1]}))},handleQuery:function(){this.params.page=1,this.params.times?(this.params.startTime=this.params.times[0],this.params.endTime=this.params.times[1],this.params.times=void 0):(this.params.startTime=void 0,this.params.endTime=void 0),this.getList()},resetQuery:function(){this.params={page:1,pageSize:20,userName:void 0,invoiceTitle:void 0,creditCode:void 0,invoiceStatus:void 0,openType:void 0,invoiceType:void 0,times:void 0,endTime:void 0,startTime:void 0},this.handleQuery()},cancellation:function(e){var t=this;this.$prompt("请输入作废原因","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"作废作废原因不能为空"}).then((function(i){var a=i.value;t.$request.invoiceCancelled({id:e.id,remark:a}).then((function(e){200==e.data.status?(t.$message.success("提交作废成功"),t.getList()):t.$message.error(e.data.msg)}))})).catch((function(){t.$message({type:"info",message:"取消作废"})}))},handleUpdate:function(e){this.reset(),this.form.id=e.id,this.open=!0,this.title="发票上传"},getList:function(){var e=this;this.loading=!0,this.$request.invoiceApplylist(this.params).then((function(t){200==t.data.status?(e.tableData=t.data.data.rows,e.total=t.data.data.records,e.params.page=t.data.data.page,e.loading=!1):(e.loading=!1,e.$message.error(t.data.msg))}))},importExcel:function(){this.$request.downloadInvoiceExcel(this.params)}}},o=(i("VlG7"),i("SsL+")),r=Object(o.a)(a,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"container"},[i("div",{staticStyle:{"padding-right":"20px",background:"#fff"}},[i("CommonSearch",{attrs:{queryParams:e.params,searchList:e.commonSearchList},on:{resetQuery:e.resetQuery,handleQuery:e.handleQuery,"update:queryParams":function(t){e.params=t},"update:query-params":function(t){e.params=t}}})],1),e._v(" "),i("div",{staticClass:"operation"},[i("div",{staticClass:"button"},[i("el-row",{staticClass:"operations-row",attrs:{gutter:10}},[i("el-col",{attrs:{span:1.5}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"mini"},on:{click:e.importExcel}},[e._v("导出Excel文件")])],1)],1)],1),e._v(" "),i("CommonTable",{attrs:{total:e.total,loading:e.loading,defColumns:e.column,dataList:e.tableData,options:e.tableOptions,page:e.params.page,limit:e.params.pageSize,operations:e.tableOperations},on:{pagination:e.getList,"update:page":function(t){return e.$set(e.params,"page",t)},"update:limit":function(t){return e.$set(e.params,"pageSize",t)}}})],1),e._v(" "),i("el-dialog",{attrs:{title:e.title,"before-close":e.cancel,visible:e.open,width:"600px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[i("el-form-item",{attrs:{label:"发票编码：",prop:"applyCode"}},[i("el-input",{attrs:{placeholder:"请输入发票编码"},model:{value:e.form.applyCode,callback:function(t){e.$set(e.form,"applyCode",t)},expression:"form.applyCode"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"开票时间：",prop:"invoiceTime"}},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},model:{value:e.form.invoiceTime,callback:function(t){e.$set(e.form,"invoiceTime",t)},expression:"form.invoiceTime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发票备注：",prop:"invoiceRemark"}},[i("el-input",{attrs:{placeholder:"请输入发票备注"},model:{value:e.form.invoiceRemark,callback:function(t){e.$set(e.form,"invoiceRemark",t)},expression:"form.invoiceRemark"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"发票上传：",prop:"invoiceUrl"}},[i("el-upload",{ref:"uploadVadio",attrs:{action:"uploadUrl","list-type":"picture-card",limit:1,"http-request":e.uploadVadioFile,headers:e.header,"with-credentials":!0}},[i("i",{staticClass:"el-icon-plus"})])],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),i("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)}),[],!1,null,"12782718",null);t.default=r.exports},VlG7:function(e,t,i){"use strict";i("HlbW")}}]);
//# sourceMappingURL=54.2bd27e0fb3b972c4bbd2.js.map